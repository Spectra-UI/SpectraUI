name: Discord Releases

on:
  release:
    types: [published]  # triggers on new release

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send release to Discord
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          # GitHub provides release info via env
          RELEASE_NAME=${{ github.event.release.name }}
          RELEASE_TAG=${{ github.event.release.tag_name }}
          RELEASE_BODY=${{ github.event.release.body }}
          AUTHOR=${{ github.event.release.author.login }}
          URL=${{ github.event.release.html_url }}

          # JSON payload for Discord embed
          JSON_PAYLOAD="{\"embeds\":[{
            \"title\":\"âœ¨ New Stable Build: $RELEASE_NAME\",
            \"description\":\"$RELEASE_BODY\",
            \"url\":\"$URL\",
            \"color\":5814783,
            \"footer\":{\"text\":\"Published by $AUTHOR | Tag: $RELEASE_TAG\"}
          }]}"

          # Send to Discord
          curl -H "Content-Type: application/json" -d "$JSON_PAYLOAD" $DISCORD_RELEASE_WEBHOOK
